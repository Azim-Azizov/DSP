clc;clear;close all;
n1=4;
n2=20;
r=0.5;
fc=0.25;
f=(0:511)/1024;
Fs=0:0.01:1;
x=0:0.01:1;
w=Fs/fc;
T4=chebyshevT(n1, x);
T20=chebyshevT(n2, x);
figure(1);
plot(x,T4,'g', x, T20, 'r'); grid on;
legend('T(4)', 'T(20)');
T4m=chebyshevT(n1,w);
T20m=chebyshevT(n2,w);
G4=1./sqrt(1+r.^2.*T4m.^2);
G20=1./sqrt(1+r.^2.*T20m.^2);
figure(2);
plot(w, G4, 'g', w, G20, 'r'); grid on; title('Frequency response (non dB)');
legend('T(4)', 'T(20)');
figure(3);
plot(w, 10*log10(G4), 'g', w, 10*log10(G20), 'r'); grid on; title('Frequency response (dB)');
legend('T(4)', 'T(20)');
%noisy signal
t=0:0.001:1;
s=sin(2*pi*25*t)+0.7*sin(2*pi*220*t);
figure(4);
subplot(211);plot(s(1:100)); grid on; title('Noisy signal');
s_out4=conv(T4,s);
s_out20=conv(T20,s);
subplot(212); plot(t(1:100), s_out4(1:100), 'b', t(1:100), s_out20(1:100), 'r'); grid on;